<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>進度查詢</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="box">
    <h2>序列號進度查詢</h2>
    <label>輸入序列號
      <input type="text" id="serialInput" placeholder="例如：A250827213045">
    </label>
    <button class="btn-query" onclick="checkSerial()">查詢進度</button>
    <div id="queryResult"></div>
    <div class="back"><a href="index.html">← 返回入口</a></div>
  </div>

<script>
  const GAS_URL = "https://script.google.com/macros/s/AKfycbz4_RUp_EPCuHN39ujVCNGNjE2BCpbqGUWsqemGWojHQEJ9DL_X_xon7sQIpZwA9bTD/exec";

  function checkSerial(){
    const serial = document.getElementById("serialInput").value.trim();
    const resultBox = document.getElementById("queryResult");
    if(!serial){
      resultBox.textContent = "請輸入序列號";
      resultBox.className = "status-error show";
      return;
    }

    fetch(GAS_URL + "?serial=" + encodeURIComponent(serial))
      .then(res => res.json())
      .then(data => {
        if(data.status === "申請中"){
          resultBox.textContent = "⏳ 申請中";
          resultBox.className = "status-pending show";
        } else if(data.status === "已核准"){
          resultBox.textContent = "✅ 已核准";
          resultBox.className = "status-approved show";
        } else {
          resultBox.textContent = "❌ 查無資料";
          resultBox.className = "status-error show";
        }
      })
      .catch(err => {
        resultBox.textContent = "錯誤：" + err;
        resultBox.className = "status-error show";
      });
  }
</script>
</body>
</html>
