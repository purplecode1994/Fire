<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é€²åº¦æŸ¥è©¢</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* é¡å¤–å¡ç‰‡ç¾åŒ– */
    .detail-card {
      background: #fdfdfd;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 15px;
      margin-top: 15px;
      font-size: 15px;
      line-height: 1.6;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .detail-card p {
      margin: 8px 0;
    }
    .detail-card b {
      color: #333;
    }
  </style>
</head>
<body>
  <div class="box">
    <h2>åºåˆ—è™Ÿé€²åº¦æŸ¥è©¢</h2>
    <label>è¼¸å…¥åºåˆ—è™Ÿ
      <input type="text" id="serialInput" placeholder="ä¾‹å¦‚ï¼šA250828145933123">
    </label>
    <button class="btn-query" onclick="checkSerial()">æŸ¥è©¢é€²åº¦</button>

    <!-- ç‹€æ…‹æç¤º -->
    <div id="queryResult"></div>

    <!-- è©³ç´°å…§å®¹ -->
    <div id="detailBox" class="detail-card" style="display:none;"></div>

    <div class="back"><a href="index.html">â† è¿”å›å…¥å£</a></div>
  </div>

<script>
  // âš ï¸ æ”¹æˆä½ æœ€æ–°éƒ¨ç½²çš„ GAS doGet exec URL
  const GAS_URL = "https://script.google.com/macros/s/AKfycbwgM8kJhScg79NL3EQCoooAjpyB4UjrTzcAN5rMnqCvnPQJWzY-2VREABWnI_e8dr3C_w/exec";

  function checkSerial(){
    const serial = document.getElementById("serialInput").value.trim();
    const box = document.getElementById("queryResult");
    const detailBox = document.getElementById("detailBox");

    if(!serial){
      box.textContent = "è«‹è¼¸å…¥åºåˆ—è™Ÿ";
      box.className = "status-error show";
      detailBox.style.display = "none";
      return;
    }

    fetch(GAS_URL + "?serial=" + encodeURIComponent(serial))
      .then(res => res.json())
      .then(data => {
        let prettyHtml = "";
        if(data.success){
          if(data.status === "ç”³è«‹ä¸­"){
            box.textContent = "â³ ç”³è«‹ä¸­";
            box.className = "status-pending show";
          } else if(data.status === "å·²æ ¸å‡†"){
            box.textContent = "âœ… å·²æ ¸å‡†";
            box.className = "status-approved show";
          } else {
            box.textContent = "âŒ æŸ¥ç„¡æ­¤åºåˆ—è™Ÿ";
            box.className = "status-error show";
          }

          // ç¾åŒ–è¼¸å‡º
          prettyHtml += `<p><b>ğŸ“Œ åºåˆ—è™Ÿï¼š</b> ${data.serial}</p>`;
          if(data.status){
            const statusIcon = data.status === "å·²æ ¸å‡†" ? "âœ…" : (data.status === "ç”³è«‹ä¸­" ? "â³" : "âŒ");
            prettyHtml += `<p><b>${statusIcon} ç‹€æ…‹ï¼š</b> ${data.status}</p>`;
          }
          if(data.message){
            prettyHtml += `<p><b>â„¹ï¸ èªªæ˜ï¼š</b> ${data.message}</p>`;
          }

        } else {
          box.textContent = "âŒ æŸ¥ç„¡æ­¤åºåˆ—è™Ÿ";
          box.className = "status-error show";
          prettyHtml = "";
        }

        // æ›´æ–°å…§å®¹å€
        detailBox.innerHTML = prettyHtml;
        detailBox.style.display = prettyHtml ? "block" : "none";
      })
      .catch(err => {
        box.textContent = "âš ï¸ ç³»çµ±ç™¼ç”ŸéŒ¯èª¤";
        box.className = "status-error show";
        detailBox.style.display = "none";
      });
  }
</script>
</body>
</html>